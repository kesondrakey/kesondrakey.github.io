<!DOCTYPE html>
<html>
<head>
    <title>Weather Calendar</title>
    <style>
        #calendar {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            grid-gap: 10px;
        }
        .calendar-cell {
            border: 1px solid #ccc;
            padding: 10px;
            text-align: center;
        }
        .calendar-header {
            background-color: #f4f4f4;
        }
        .info-box {
            display: none;
        }
        .calendar-cell:hover .info-box {
            display: block;
        }
    </style>
</head>
<body>
    <button id="prev">Prev</button>
    <button id="next">Next</button>
    <div id="calendar"></div>

    <script>
        let currentMonth = new Date().getMonth();
        let currentYear = new Date().getFullYear();

        document.getElementById("prev").addEventListener("click", function() {
            currentMonth--;
            if (currentMonth < 0) {
                currentMonth = 11;
                currentYear--;
            }
            loadCalendar();
        });

        document.getElementById("next").addEventListener("click", function() {
            currentMonth++;
            if (currentMonth > 11) {
                currentMonth = 0;
                currentYear++;
            }
            loadCalendar();
        });

        function loadCalendar() {
            fetch("../files/daily_fluxtower1.json")
                .then(response => response.json())
                .then(jsonData => {
                    const calendarEl = document.getElementById('calendar');
                    calendarEl.innerHTML = '';

                    ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'].forEach(day => {
                        const header = document.createElement('div');
                        header.className = 'calendar-cell calendar-header';
                        header.innerText = day;
                        calendarEl.appendChild(header);
                    });

                    const firstDay = new Date(currentYear, currentMonth, 1).getDay();
                    const lastDate = new Date(currentYear, currentMonth + 1, 0).getDate();

                    for (let i = 1; i <= (firstDay + lastDate); i++) {
                        const cell = document.createElement('div');
                        cell.className = 'calendar-cell';

                        if (i > firstDay) {
                            const date = i - firstDay;
                            const dayData = jsonData.find(d => new Date(d.DATE).getDate() === date && new Date(d.DATE).getMonth() === currentMonth);

                            if (dayData) {
                                const icon = dayData.Description === "Sunny" ? "../images/sun.png" : "../images/rain.png";
                                const infoBox = `
                                    <div class="info-box">
                                        Max Temp: ${dayData["Max.Temp"]} <br>
                                        Min Temp: ${dayData["Min.Temp"]} <br>
                                        Total Precip: ${dayData["Total.Precipitation"]} <br>
                                    </div>
                                `;
                                cell.innerHTML = `
                                    <div>${date}</div>
                                    <img src="${icon}" width="24" height="24">
                                    ${infoBox}
                                `;
                            }
                        }

                        calendarEl.appendChild(cell);
                    }
                });
        }

        loadCalendar();
    </script>
</body>
</html>
